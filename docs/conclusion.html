<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Conclusion</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">FGV MBA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-hand-holding-usd"></span>
     
    Business Case
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_about_the_data.html">About the Data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Initial Analysis</li>
    <li>
      <a href="02_data_preparation.html">Data Preparation</a>
    </li>
    <li>
      <a href="03_exploration_report.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-invoice-dollar"></span>
     
    Final Report
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="conclusion.html">Conclusion</a>
    </li>
    <li>
      <a href="references.html">References</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Conclusion</h1>
<h4 class="date">September, 2019</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#objective">Objective</a></li>
<li><a href="#pergunta-1">Pergunta 1</a></li>
<li><a href="#pergunta-2">Pergunta 2</a></li>
<li><a href="#pergunta-3">Pergunta 3</a></li>
<li><a href="#pergunta-4">Pergunta 4</a></li>
<li><a href="#pergunta-5">Pergunta 5</a></li>
<li><a href="#pergunta-6">Pergunta 6</a></li>
<li><a href="#pergunta-7-bonus">Pergunta 7 (bônus)</a></li>
<li><a href="#pergunta-8-bonus-2">Pergunta 8 (bônus 2)</a></li>
</ul>
</div>

<div id="objective" class="section level1">
<h1>Objective</h1>
<p>The objective of this reports is to answer the Spatial Statistcs assignment class given by the professor Eduardo Franscisco.</p>
<p>The target dataset and shapefile is the one already processed during the data preparation phase. Thus, for the final reports we have to start by loading the processed shapefile.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># performing data (processed) loading</span></a>
<a class="sourceLine" id="cb1-2" title="2">dataRawDirectory &lt;-<span class="st"> &quot;./data/processed/&quot;</span></a>
<a class="sourceLine" id="cb1-3" title="3">shapefile_to_read &lt;-<span class="st"> </span><span class="kw">paste</span>(dataRawDirectory, <span class="st">&quot;crime_mg_processed.shp&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">target &lt;-<span class="st"> </span><span class="kw">readOGR</span>(shapefile_to_read, <span class="dt">encoding=</span><span class="st">&quot;UTF-8&quot;</span>)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;D:\OneDrive\FGV\04_Modulos\06 - Estatistica Espacial\Spatial-Statistics\data\processed\crime_mg_processed.shp&quot;, layer: &quot;crime_mg_processed&quot;
## with 754 features
## It has 17 fields</code></pre>
<hr />
</div>
<div id="pergunta-1" class="section level1">
<h1>Pergunta 1</h1>
<p>Qual das variáveis quantitativas apresentadas no shapefile crime_mg apresenta maior auto-correlação espacial? Descreva como implementou a matriz de vizinhança. Apresente o I de Moran e o mapa de auto-correlação espacial local (LISA map) da variável escolhida e também de pelo menos outras 3 variáveis.</p>
<p>Obs: desconsidere as variáveis Codmuni, ID, X_coord e Y_coord nessa análise.</p>
<p><strong>Resposta</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># getting the centroids of the polygons</span></a>
<a class="sourceLine" id="cb3-2" title="2">xy &lt;-<span class="st"> </span><span class="kw">coordinates</span>(target) </a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># neighborhood matrix from spatial polygons / adjacent polygons</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co"># using the spdep library to generate first order</span></a>
<a class="sourceLine" id="cb3-7" title="7">ap &lt;-<span class="st"> </span><span class="kw">poly2nb</span>(target, <span class="dt">queen =</span> T, <span class="dt">row.names =</span> target<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb3-8" title="8">lw &lt;-<span class="st"> </span><span class="kw">nb2listw</span>(ap, <span class="dt">style =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">zero.policy =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">plot</span>(target, <span class="dt">col =</span> <span class="st">&#39;cadetblue2&#39;</span>, <span class="dt">border =</span> <span class="st">&#39;deepskyblue4&#39;</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">plot</span>(ap, xy, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-1.png" width="100%" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># using the bamlss library</span></a>
<a class="sourceLine" id="cb4-2" title="2">nm &lt;-<span class="st"> </span><span class="kw">neighbormatrix</span>(target, <span class="dt">type =</span> <span class="st">&quot;boundary&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">plotneighbors</span>(target)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-2.png" width="100%" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">plotneighbors</span>(target, <span class="dt">type =</span> <span class="st">&quot;delaunay&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      PLEASE NOTE:  The components &quot;delsgs&quot; and &quot;summary&quot; of the
##  object returned by deldir() are now DATA FRAMES rather than
##  matrices (as they were prior to release 0.0-18).
##  See help(&quot;deldir&quot;).
##  
##      PLEASE NOTE: The process that deldir() uses for determining
##  duplicated points has changed from that used in version
##  0.0-9 of this package (and previously). See help(&quot;deldir&quot;).</code></pre>
<p><img src="conclusion_files/figure-html/pergunta_1-3.png" width="100%" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">plotneighbors</span>(target, <span class="dt">type =</span> <span class="st">&quot;dist&quot;</span>, <span class="dt">d1 =</span> <span class="dv">0</span>, <span class="dt">d2 =</span> <span class="fl">0.15</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-4.png" width="100%" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># global autocorrelation tests: Moran&#39;s I</span></a>
<a class="sourceLine" id="cb8-2" title="2">moran.test.AREA     &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>AREA, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T) </a>
<a class="sourceLine" id="cb8-3" title="3">moran.test.INDICE94 &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>INDICE94, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-4" title="4">moran.test.INDICE95 &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>INDICE95, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-5" title="5">moran.test.GINI_<span class="dv">91</span>  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>GINI_<span class="dv">91</span>, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-6" title="6">moran.test.POP_<span class="dv">94</span>   &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_<span class="dv">94</span>, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-7" title="7">moran.test.POP_RUR  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_RUR, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-8" title="8">moran.test.POP_URB  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_URB, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-9" title="9">moran.test.POP_FEM  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_FEM, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-10" title="10">moran.test.POP_MAS  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_MAS, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-11" title="11">moran.test.POP_TOT  &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>POP_TOT, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-12" title="12">moran.test.URBLEVEL &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>URBLEVEL, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-13" title="13">moran.test.PIB_PC   &lt;-<span class="st"> </span><span class="kw">moran.test</span>(target<span class="op">$</span>PIB_PC, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a>
<a class="sourceLine" id="cb8-14" title="14"></a>
<a class="sourceLine" id="cb8-15" title="15">moran.test.all &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;AREA&quot;</span> =<span class="st"> </span>moran.test.AREA<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-16" title="16">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;INDICE94&quot;</span> =<span class="st"> </span>moran.test.INDICE94<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-17" title="17">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;INDICE95&quot;</span> =<span class="st"> </span>moran.test.INDICE95<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-18" title="18">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;GINI_91&quot;</span> =<span class="st"> </span>moran.test.GINI_<span class="dv">91</span><span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-19" title="19">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_94&quot;</span> =<span class="st"> </span>moran.test.POP_<span class="dv">94</span><span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-20" title="20">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_RUR&quot;</span> =<span class="st"> </span>moran.test.POP_RUR<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-21" title="21">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_URB&quot;</span> =<span class="st"> </span>moran.test.POP_URB<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-22" title="22">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_FEM&quot;</span> =<span class="st"> </span>moran.test.POP_FEM<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-23" title="23">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_MAS&quot;</span> =<span class="st"> </span>moran.test.POP_MAS<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-24" title="24">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;POP_TOT&quot;</span> =<span class="st"> </span>moran.test.POP_TOT<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-25" title="25">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;URBLEVEL&quot;</span> =<span class="st"> </span>moran.test.URBLEVEL<span class="op">$</span>estimate)),</a>
<a class="sourceLine" id="cb8-26" title="26">                        <span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;PIB_PC&quot;</span> =<span class="st"> </span>moran.test.PIB_PC<span class="op">$</span>estimate)))</a>
<a class="sourceLine" id="cb8-27" title="27"></a>
<a class="sourceLine" id="cb8-28" title="28">moran.test.all &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(moran.test.all, <span class="dt">rownames =</span> <span class="st">&quot;Variables&quot;</span>)</a>
<a class="sourceLine" id="cb8-29" title="29">moran.test.all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Moran I statistic</span><span class="st">`</span>))</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;cli&#39;:
##   method     from    
##   print.boxx spatstat</code></pre>
<pre><code>## # A tibble: 12 x 4
##    Variables `Moran I statistic` Expectation Variance
##    &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
##  1 AREA                    0.551    -0.00133 0.000474
##  2 INDICE94                0.316    -0.00133 0.000498
##  3 INDICE95                0.303    -0.00133 0.000499
##  4 URBLEVEL                0.291    -0.00133 0.000499
##  5 POP_RUR                 0.291    -0.00133 0.000487
##  6 GINI_91                 0.130    -0.00133 0.000492
##  7 POP_94                  0.130    -0.00133 0.000180
##  8 POP_MAS                 0.128    -0.00133 0.000180
##  9 POP_TOT                 0.123    -0.00133 0.000172
## 10 PIB_PC                  0.122    -0.00133 0.000466
## 11 POP_FEM                 0.118    -0.00133 0.000165
## 12 POP_URB                 0.116    -0.00133 0.000157</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">print</span>(moran.test.all)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    Variables `Moran I statistic` Expectation Variance
##    &lt;chr&gt;                   &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
##  1 AREA                    0.551    -0.00133 0.000474
##  2 INDICE94                0.316    -0.00133 0.000498
##  3 INDICE95                0.303    -0.00133 0.000499
##  4 GINI_91                 0.130    -0.00133 0.000492
##  5 POP_94                  0.130    -0.00133 0.000180
##  6 POP_RUR                 0.291    -0.00133 0.000487
##  7 POP_URB                 0.116    -0.00133 0.000157
##  8 POP_FEM                 0.118    -0.00133 0.000165
##  9 POP_MAS                 0.128    -0.00133 0.000180
## 10 POP_TOT                 0.123    -0.00133 0.000172
## 11 URBLEVEL                0.291    -0.00133 0.000499
## 12 PIB_PC                  0.122    -0.00133 0.000466</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Moran scatterplot for INDICE94</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">moran.plot</span>(target<span class="op">$</span>INDICE94, </a>
<a class="sourceLine" id="cb13-4" title="4">           <span class="dt">listw =</span> lw, </a>
<a class="sourceLine" id="cb13-5" title="5">           <span class="dt">zero.policy =</span> T,</a>
<a class="sourceLine" id="cb13-6" title="6">           <span class="dt">pch =</span> <span class="dv">16</span>, </a>
<a class="sourceLine" id="cb13-7" title="7">           <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb13-8" title="8">           <span class="dt">cex =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb13-9" title="9">           <span class="dt">quiet =</span> F,</a>
<a class="sourceLine" id="cb13-10" title="10">           <span class="dt">labels =</span> <span class="kw">as.character</span>(target<span class="op">$</span>MUNIC),</a>
<a class="sourceLine" id="cb13-11" title="11">           <span class="dt">xlab =</span> <span class="st">&quot;Percent for INDICE94&quot;</span>,</a>
<a class="sourceLine" id="cb13-12" title="12">           <span class="dt">ylab =</span> <span class="st">&quot;Percent for INDICE94 (Spatial Lag)&quot;</span>, </a>
<a class="sourceLine" id="cb13-13" title="13">           <span class="dt">main =</span> <span class="st">&quot;Moran Scatterplot&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-5.png" width="100%" /></p>
<pre><code>## Potentially influential observations of
##   lm(formula = wx ~ x) :
## 
##                             dfb.1_ dfb.x dffit   cov.r   cook.d hat    
## Abadia dos Dourados          0.07  -0.03  0.10    0.99_*  0.00   0.00  
## Abaeté                      -0.04   0.06  0.06    1.01_*  0.00   0.01_*
## Água Comprida               -0.13   0.24  0.30_*  0.95_*  0.04   0.00  
## Alfenas                      0.01  -0.01 -0.02    1.01_*  0.00   0.01  
## Araçaí                       0.00  -0.01 -0.01    1.02_*  0.00   0.01_*
## Belo Horizonte              -0.01   0.01  0.01    1.01_*  0.00   0.01_*
## Cachoeira Dourada            0.10  -0.15 -0.16_*  1.00    0.01   0.01_*
## Caetanópolis                 0.00   0.06  0.12    0.98_*  0.01   0.00  
## Canápolis                    0.10  -0.07  0.11    0.99_*  0.01   0.00  
## Capim Branco                -0.02   0.09  0.14    0.98_*  0.01   0.00  
## Carmo do Cajuru              0.02  -0.03 -0.03    1.01_*  0.00   0.01  
## Cedro do Abaeté              0.13  -0.17 -0.17_*  1.02_*  0.01   0.02_*
## Chácara                      0.01  -0.02 -0.02    1.02_*  0.00   0.02_*
## Conceição das Alagoas       -0.17   0.24  0.26_*  1.00    0.03   0.01_*
## Conceição das Pedras         0.01  -0.01  0.01    1.01_*  0.00   0.01  
## Conquista                    0.18  -0.13  0.19_*  0.97_*  0.02   0.00  
## Cordisburgo                  0.04   0.00  0.08    0.99_*  0.00   0.00  
## Coronel Pacheco              0.04   0.01  0.10    0.99_*  0.00   0.00  
## Cristais                     0.03  -0.04 -0.04    1.01_*  0.00   0.01  
## Cristália                   -0.04  -0.01 -0.09    0.99_*  0.00   0.00  
## Curvelo                      0.02  -0.03 -0.04    1.01_*  0.00   0.01  
## Dores do Indaiá              0.01  -0.02 -0.02    1.01_*  0.00   0.01  
## Douradoquara                 0.04   0.00  0.10    0.99_*  0.00   0.00  
## Estrela do Sul               0.10  -0.06  0.12    0.99_*  0.01   0.00  
## Ewbank da Câmara             0.07  -0.02  0.10    0.98_*  0.01   0.00  
## Fama                         0.07  -0.10 -0.11    1.01_*  0.01   0.01_*
## Felixlândia                  0.08  -0.04  0.09    0.99_*  0.00   0.00  
## Fortuna de Minas             0.08  -0.11 -0.12    1.01_*  0.01   0.01_*
## Frei Inocêncio               0.14  -0.19 -0.19_*  1.01_*  0.02   0.02_*
## Fronteira                    0.00   0.00  0.00    1.02_*  0.00   0.01_*
## Funilândia                  -0.03   0.08  0.12    0.99_*  0.01   0.00  
## Governador Valadares         0.14  -0.20 -0.21_*  1.00    0.02   0.01_*
## Grupiara                    -0.03   0.04  0.05    1.01_*  0.00   0.01  
## Gurinhatã                    0.11  -0.07  0.12    0.99_*  0.01   0.00  
## Igarapé                     -0.02   0.03  0.03    1.01_*  0.00   0.01  
## Indianópolis                 0.05   0.00  0.10    0.99_*  0.00   0.00  
## Inhaúma                      0.06  -0.02  0.09    0.99_*  0.00   0.00  
## Ipiaçu                       0.04  -0.06 -0.06    1.01_*  0.00   0.01_*
## Iraí de Minas               -0.01   0.02  0.02    1.01_*  0.00   0.01_*
## Juiz de Fora                 0.02  -0.04 -0.04    1.01_*  0.00   0.01  
## Lagoa da Prata              -0.02   0.02  0.03    1.01_*  0.00   0.01  
## Maravilhas                   0.11  -0.08  0.12    0.99_*  0.01   0.00  
## Mata Verde                   0.03  -0.09 -0.14    0.98_*  0.01   0.00  
## Matias Lobato                0.13  -0.07  0.16_*  0.97_*  0.01   0.00  
## Matozinhos                  -0.01   0.02  0.02    1.01_*  0.00   0.01  
## Monte Carmelo                0.02  -0.03 -0.03    1.02_*  0.00   0.01_*
## Montes Claros                0.19  -0.26 -0.27_*  1.00    0.04   0.01_*
## Morada Nova de Minas         0.03  -0.04 -0.04    1.01_*  0.00   0.01_*
## Olímpio Noronha              0.00  -0.06 -0.11    0.99_*  0.01   0.00  
## Paineiras                    0.00   0.05  0.11    0.98_*  0.01   0.00  
## Papagaios                   -0.01   0.01  0.01    1.01_*  0.00   0.01_*
## Pavão                        0.11  -0.07  0.12    0.99_*  0.01   0.00  
## Pirajuba                    -0.12   0.18  0.19_*  1.00    0.02   0.01_*
## Planura                     -0.16   0.22  0.23_*  1.01    0.03   0.01_*
## Prudente de Morais          -0.09   0.13  0.14    1.01_*  0.01   0.01_*
## Quartel Geral                0.12  -0.08  0.14    0.98_*  0.01   0.00  
## Queluzito                    0.00   0.00  0.00    1.01_*  0.00   0.01  
## Santa Luzia                  0.00   0.00  0.00    1.01_*  0.00   0.01_*
## São Francisco de Sales       0.02  -0.03 -0.03    1.01_*  0.00   0.01  
## São Gonçalo do Pará          0.09  -0.05  0.11    0.99_*  0.01   0.00  
## São Tomé das Letras          0.02  -0.03 -0.03    1.01_*  0.00   0.01_*
## Senador Modestino Gonçalves  0.09  -0.13 -0.14    1.01_*  0.01   0.01_*
## Serra da Saudade             0.03  -0.04 -0.04    1.01_*  0.00   0.01_*
## Serra dos Aimorés            0.00   0.00  0.00    1.01_*  0.00   0.01  
## Sete Lagoas                 -0.02   0.03  0.03    1.01_*  0.00   0.01_*
## Teófilo Otôni                0.15  -0.22 -0.24_*  1.00    0.03   0.01_*
## Tiradentes                   0.13  -0.18 -0.19_*  1.00    0.02   0.01_*
## Uberaba                      0.02  -0.03 -0.03    1.02_*  0.00   0.02_*
## Uberlândia                  -0.06   0.09  0.10    1.01_*  0.00   0.01_*
## Unaí                         0.08  -0.12 -0.13    1.01    0.01   0.01_*
## Veríssimo                   -0.10   0.16  0.17_*  1.00    0.01   0.01</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># LISA map for INDICE94 </span></a>
<a class="sourceLine" id="cb15-2" title="2">locm &lt;-<span class="st"> </span><span class="kw">localmoran</span>(target<span class="op">$</span>INDICE94,lw)</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4">target<span class="op">$</span>sPPOV &lt;-<span class="st"> </span><span class="kw">scale</span>(target<span class="op">$</span>INDICE94)</a>
<a class="sourceLine" id="cb15-5" title="5">target<span class="op">$</span>lag_sPPOV &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(lw, target<span class="op">$</span>sPPOV)</a>
<a class="sourceLine" id="cb15-6" title="6"></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">plot</span>(<span class="dt">x =</span> target<span class="op">$</span>sPPOV, <span class="dt">y =</span> target<span class="op">$</span>lag_sPPOV, <span class="dt">main =</span> <span class="st">&quot;Moran Scatterplot PPOV&quot;</span>)</a>
<a class="sourceLine" id="cb15-8" title="8"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">abline</span>(<span class="kw">lm</span>(target<span class="op">$</span>lag_sPPOV <span class="op">~</span><span class="st"> </span>target<span class="op">$</span>sPPOV), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-6.png" width="100%" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># check out the outliers click on one or two and then hit escape or click finish</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co"># identify(target$sPPOV, target$lag_sPPOV, target$INDICE94, cex = 0.8)</span></a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4">target<span class="op">$</span>quad_sig &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb16-5" title="5">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb16-6" title="6">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb16-7" title="7">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb16-8" title="8">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb16-9" title="9">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11">breaks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-12" title="12">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;High-High&quot;</span>, <span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>)</a>
<a class="sourceLine" id="cb16-13" title="13">np &lt;-<span class="st"> </span><span class="kw">findInterval</span>(target<span class="op">$</span>quad_sig, breaks)</a>
<a class="sourceLine" id="cb16-14" title="14">colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb16-15" title="15"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb16-16" title="16"><span class="kw">plot</span>(target, <span class="dt">col =</span> colors[np])</a>
<a class="sourceLine" id="cb16-17" title="17"><span class="kw">mtext</span>(<span class="st">&quot;Local Moran&#39;s I - INDICE94&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-18" title="18"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> labels, <span class="dt">fill =</span> colors, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-7.png" width="100%" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># LISA map for INDICE95 </span></a>
<a class="sourceLine" id="cb17-2" title="2">locm &lt;-<span class="st"> </span><span class="kw">localmoran</span>(target<span class="op">$</span>INDICE95,lw)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4">target<span class="op">$</span>sPPOV &lt;-<span class="st"> </span><span class="kw">scale</span>(target<span class="op">$</span>INDICE95)</a>
<a class="sourceLine" id="cb17-5" title="5">target<span class="op">$</span>lag_sPPOV &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(lw, target<span class="op">$</span>sPPOV)</a>
<a class="sourceLine" id="cb17-6" title="6">target<span class="op">$</span>quad_sig &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb17-7" title="7">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-8" title="8">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb17-9" title="9">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb17-10" title="10">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb17-11" title="11">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">breaks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-14" title="14">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;High-High&quot;</span>, <span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>)</a>
<a class="sourceLine" id="cb17-15" title="15">np &lt;-<span class="st"> </span><span class="kw">findInterval</span>(target<span class="op">$</span>quad_sig, breaks)</a>
<a class="sourceLine" id="cb17-16" title="16">colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb17-17" title="17"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb17-18" title="18"><span class="kw">plot</span>(target, <span class="dt">col =</span> colors[np])</a>
<a class="sourceLine" id="cb17-19" title="19"><span class="kw">mtext</span>(<span class="st">&quot;Local Moran&#39;s I - INDICE95&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-20" title="20"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> labels, <span class="dt">fill =</span> colors, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-8.png" width="100%" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># LISA map for URBLEVEL </span></a>
<a class="sourceLine" id="cb18-2" title="2">locm &lt;-<span class="st"> </span><span class="kw">localmoran</span>(target<span class="op">$</span>URBLEVEL,lw)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4">target<span class="op">$</span>sPPOV &lt;-<span class="st"> </span><span class="kw">scale</span>(target<span class="op">$</span>URBLEVEL)</a>
<a class="sourceLine" id="cb18-5" title="5">target<span class="op">$</span>lag_sPPOV &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(lw, target<span class="op">$</span>sPPOV)</a>
<a class="sourceLine" id="cb18-6" title="6">target<span class="op">$</span>quad_sig &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb18-7" title="7">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb18-8" title="8">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb18-9" title="9">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb18-10" title="10">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb18-11" title="11">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13">breaks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-14" title="14">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;High-High&quot;</span>, <span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>)</a>
<a class="sourceLine" id="cb18-15" title="15">np &lt;-<span class="st"> </span><span class="kw">findInterval</span>(target<span class="op">$</span>quad_sig, breaks)</a>
<a class="sourceLine" id="cb18-16" title="16">colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb18-17" title="17"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-18" title="18"><span class="kw">plot</span>(target, <span class="dt">col =</span> colors[np])</a>
<a class="sourceLine" id="cb18-19" title="19"><span class="kw">mtext</span>(<span class="st">&quot;Local Moran&#39;s I - URBLEVEL&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-20" title="20"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> labels, <span class="dt">fill =</span> colors, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-9.png" width="100%" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># LISA map for POPRUR </span></a>
<a class="sourceLine" id="cb19-2" title="2">locm &lt;-<span class="st"> </span><span class="kw">localmoran</span>(target<span class="op">$</span>POP_RUR,lw)</a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4">target<span class="op">$</span>sPPOV &lt;-<span class="st"> </span><span class="kw">scale</span>(target<span class="op">$</span>POP_RUR)</a>
<a class="sourceLine" id="cb19-5" title="5">target<span class="op">$</span>lag_sPPOV &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(lw, target<span class="op">$</span>sPPOV)</a>
<a class="sourceLine" id="cb19-6" title="6">target<span class="op">$</span>quad_sig &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb19-7" title="7">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb19-8" title="8">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb19-9" title="9">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb19-10" title="10">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb19-11" title="11">target<span class="op">@</span>data[(target<span class="op">$</span>sPPOV <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>target<span class="op">$</span>lag_sPPOV <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(locm[, <span class="dv">5</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;quad_sig&quot;</span>] &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb19-12" title="12"></a>
<a class="sourceLine" id="cb19-13" title="13">breaks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-14" title="14">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;High-High&quot;</span>, <span class="st">&quot;Low-Low&quot;</span>, <span class="st">&quot;High-Low&quot;</span>, <span class="st">&quot;Low-High&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>)</a>
<a class="sourceLine" id="cb19-15" title="15">np &lt;-<span class="st"> </span><span class="kw">findInterval</span>(target<span class="op">$</span>quad_sig, breaks)</a>
<a class="sourceLine" id="cb19-16" title="16">colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb19-17" title="17"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb19-18" title="18"><span class="kw">plot</span>(target, <span class="dt">col =</span> colors[np])</a>
<a class="sourceLine" id="cb19-19" title="19"><span class="kw">mtext</span>(<span class="st">&quot;Local Moran&#39;s I - POPRUR&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-20" title="20"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> labels, <span class="dt">fill =</span> colors, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_1-10.png" width="100%" /></p>
<hr />
</div>
<div id="pergunta-2" class="section level1">
<h1>Pergunta 2</h1>
<p>Implemente o modelo espacial auto-regressivo (SAR) da variável Indice95 (índice de criminalidade em 1995 de Minas Gerais) a partir de apenas uma variável independente (não pode ser Indice94, Codmuni, ID, X_coord nem Y_coord). Apresente o resultado da regressão linear simples e da regressão linear espacial. Apresente as equações e interprete seus coeficientes.</p>
<p><strong>Resposta</strong></p>
<p>Equação da regressão linear simples:</p>
<p><span class="math inline">\(INDICE95= 6.3208+16.9877*URBLEVEL\)</span></p>
<p>Interpretando os coeficientes do modelo de regressão linear simples temos que, para cada ponto adicional do índice de urbanização (URBLEVEL), é esperado um aumento de aproximadamente 16.99 no índice de criminalidade INDICE95.</p>
<p>Para um município com o índice de urbanização 0 é esperado um índice de criminalidade de aproximadamente 6.32.</p>
<p>Equação da regressão espacial (SAR):</p>
<p><span class="math inline">\(INDICE95= 2.35307+13.93704*URBLEVEL+0.35437*LAG_INDICE95\)</span></p>
<p>Interpretando os coeficientes do modelo de regressão espacial (SAR) temos que, para cada ponto adicional do índice de urbanização (URBLEVEL), é esperado um aumento de aproximadamente 13.94 no índice de criminalidade INDICE95.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># initial setup</span></a>
<a class="sourceLine" id="cb20-2" title="2">res.palette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;green&quot;</span>), </a>
<a class="sourceLine" id="cb20-3" title="3">                                <span class="dt">space =</span> <span class="st">&quot;rgb&quot;</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">pal &lt;-<span class="st"> </span><span class="kw">res.palette</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb20-6" title="6"></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co"># linear regresion model</span></a>
<a class="sourceLine" id="cb20-8" title="8">target.lm.model &lt;-<span class="st"> </span><span class="kw">lm</span>(INDICE95 <span class="op">~</span><span class="st"> </span>URBLEVEL, <span class="dt">data =</span> target)</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">summary</span>(target.lm.model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = INDICE95 ~ URBLEVEL, data = target)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.873  -4.664  -1.174   3.639  37.569 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.3208     0.6251   10.11   &lt;2e-16 ***
## URBLEVEL     16.9877     1.0667   15.93   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.845 on 752 degrees of freedom
## Multiple R-squared:  0.2522, Adjusted R-squared:  0.2512 
## F-statistic: 253.6 on 1 and 752 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">target.lm.model.residuals &lt;-<span class="st"> </span>target.lm.model<span class="op">$</span>residuals</a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3">target.lm.model.class_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.lm.model.residuals, </a>
<a class="sourceLine" id="cb22-4" title="4">                                           <span class="dt">n =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb22-5" title="5">                                           <span class="dt">style =</span> <span class="st">&quot;fixed&quot;</span>,</a>
<a class="sourceLine" id="cb22-6" title="6">                                           <span class="dt">fixedBreaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">25</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">50</span>),</a>
<a class="sourceLine" id="cb22-7" title="7">                                           <span class="dt">rtimes =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-8" title="8"></a>
<a class="sourceLine" id="cb22-9" title="9">cols.lm &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.lm.model.class_fx, pal)</a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.lm, <span class="dt">main =</span> <span class="st">&quot;OLS Model&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb22-12" title="12"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.lm, <span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb22-13" title="13">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.lm, <span class="st">&quot;table&quot;</span>)), <span class="dt">title =</span> <span class="st">&quot;Residuals from OLS Model&quot;</span>,</a>
<a class="sourceLine" id="cb22-14" title="14">       <span class="dt">ncol =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_2-1.png" width="100%" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">moran.test</span>(target.lm.model.residuals, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.lm.model.residuals  
## weights: lw    
## 
## Moran I statistic standard deviate = 7.546, p-value = 2.243e-14
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.1669929330     -0.0013280212      0.0004975504</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># SAR model (Spatial Auto-Regressive)</span></a>
<a class="sourceLine" id="cb25-2" title="2">target.sar.model &lt;-<span class="st"> </span><span class="kw">lagsarlm</span>(INDICE95 <span class="op">~</span><span class="st"> </span>URBLEVEL, </a>
<a class="sourceLine" id="cb25-3" title="3">                             <span class="dt">data =</span> target, </a>
<a class="sourceLine" id="cb25-4" title="4">                             <span class="dt">listw =</span> lw,</a>
<a class="sourceLine" id="cb25-5" title="5">                             <span class="dt">zero.policy =</span> T, </a>
<a class="sourceLine" id="cb25-6" title="6">                             <span class="dt">tol.solve =</span> <span class="fl">1e-12</span>)</a></code></pre></div>
<pre><code>## Warning: Function lagsarlm moved to the spatialreg package</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">summary</span>(target.sar.model)</a></code></pre></div>
<pre><code>## 
## Call:spatialreg::lagsarlm(formula = formula, data = data, listw = listw, 
##     na.action = na.action, Durbin = Durbin, type = type, method = method, 
##     quiet = quiet, zero.policy = zero.policy, interval = interval, 
##     tol.solve = tol.solve, trs = trs, control = control)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.2482  -4.2371  -1.0771   3.3952  33.9250 
## 
## Type: lag 
## Coefficients: (asymptotic standard errors) 
##             Estimate Std. Error z value  Pr(&gt;|z|)
## (Intercept)  2.35307    0.79725  2.9515  0.003163
## URBLEVEL    13.93704    1.04857 13.2914 &lt; 2.2e-16
## 
## Rho: 0.35437, LR test value: 66.163, p-value: 4.4409e-16
## Asymptotic standard error: 0.044457
##     z-value: 7.9712, p-value: 1.5543e-15
## Wald statistic: 63.539, p-value: 1.5543e-15
## 
## Log likelihood: -2486.1 for lag model
## ML residual variance (sigma squared): 41.776, (sigma: 6.4634)
## Number of observations: 754 
## Number of parameters estimated: 4 
## AIC: 4980.2, (AIC for lm: 5044.4)
## LM test for residual autocorrelation
## test value: 10.579, p-value: 0.001144</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">target.sar.model<span class="op">$</span>rest.se</a></code></pre></div>
<pre><code>## (Intercept)    URBLEVEL 
##   0.7972549   1.0485725</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">target.sar.model<span class="op">$</span>residuals</a></code></pre></div>
<pre><code>##            0            1            2            3            4 
##  -1.58573227  15.11949080  -2.88834928  -3.59293083  -3.61613767 
##            5            6            7            8            9 
##   2.89833156   7.72429160   1.58579267   7.48895546  -5.57317267 
##           10           11           12           13           14 
##   1.67737185  -5.80996633   0.59142126   8.98849681  -6.55369940 
##           15           16           17           18           19 
##   7.02921055   3.70401583   6.27599211  -1.85572889   2.33982819 
##           20           21           22           23           24 
##   1.10199730  -8.98115413   4.71231028  -9.56843638  -7.27033724 
##           25           26           27           28           29 
##   3.25958189  -5.66083628   3.66781636  -5.67019504  -1.97096879 
##           30           31           32           33           34 
##   0.48106697  -6.90524423   7.25894489 -13.06181545   0.70453362 
##           35           36           37           38           39 
##   9.25561950   5.85086023  -1.88716797  19.68552390  -5.23508915 
##           40           41           42           43           44 
## -11.19562680   3.04650663   3.02672027  -2.30617984   0.87083261 
##           45           46           47           48           49 
##  -5.85216659   0.35140497  -8.98355022  -1.35592676  -1.46917863 
##           50           51           52           53           54 
##  -3.00784683   0.61006736   0.33505702  -7.33656753  -4.41819925 
##           55           56           57           58           59 
##  -5.01117378 -10.18779603   0.87865604  -4.43693321  -1.46131032 
##           60           61           62           63           64 
##  -6.58105040  -0.40488887   7.06364395  -5.54560832  -0.59904728 
##           65           66           67           68           69 
##  -2.05088288  -0.59279586   0.22818612  -0.05750345   5.65612459 
##           70           71           72           73           74 
##   5.20976234   5.05161331   1.84464065  -1.90801164  -3.08056635 
##           75           76           77           78           79 
##  -4.59154537  -3.39395454  -3.28119985  -0.78346958   0.08334148 
##           80           81           82           83           84 
##   3.43212622  -0.66399318  -9.57119206  -4.79523292  -5.36106607 
##           85           86           87           88           89 
##  -3.85690642  -7.25241253  -3.91356042  19.16841613  -7.60572614 
##           90           91           92           93           94 
##  -2.10971813  -0.98323884   2.22939877   3.88033430  -2.80588312 
##           95           96           97           98           99 
##  -0.10297392  -2.50072112  -6.58254136  -4.04622512  25.90145957 
##          100          101          102          103          104 
##  -5.30003233  -5.21244221  10.81695112   5.51994688  -3.62798425 
##          105          106          107          108          109 
##  -1.07282017  -1.41845979  13.31565083   5.99416880   3.00837678 
##          110          111          112          113          114 
##   1.48108706   4.30067213   1.25054247  -3.44519520  -0.44414583 
##          115          116          117          118          119 
##  -3.04894270   1.43084850  -3.61763926  14.31257108  -2.10432951 
##          120          121          122          123          124 
##  -9.13565165  -0.33138172   8.69580572  -6.74358315  -0.12724273 
##          125          126          127          128          129 
##   6.00161319  -4.49011104  -5.68782850  -0.83002606   3.46237119 
##          130          131          132          133          134 
##   6.55085422  -2.15156750  -4.46078935  -1.99631583  -0.15945117 
##          135          136          137          138          139 
##   6.09146182  -0.64605722  -0.45495484  -3.70553789   2.13474371 
##          140          141          142          143          144 
##   4.12640838  -5.37261491  -5.17013550  -2.40390927  15.84480295 
##          145          146          147          148          149 
##  -2.54979425   1.37498915  -1.40688649   4.48276526   1.42360790 
##          150          151          152          153          154 
##  -6.35673837  -1.37432981 -12.01918078  -3.90067989   4.28776460 
##          155          156          157          158          159 
##  -3.87588211   5.54202337   1.07757022   2.85922473   6.63077317 
##          160          161          162          163          164 
##  -9.18489442  -6.96137542   0.08247184   0.74750599  -3.52734005 
##          165          166          167          168          169 
##  -5.38241310  16.84245021   4.63642959  -6.12427857  -3.09866679 
##          170          171          172          173          174 
##   4.85725037  -2.39560748  -5.36947685  -2.26580753  -1.72517906 
##          175          176          177          178          179 
##  -5.77237309  10.82785885 -10.69102821  -4.76761724   4.21529988 
##          180          181          182          183          184 
##  10.73993175  -0.99591862  -5.45879181  -5.54644962  -2.00934544 
##          185          186          187          188          189 
##  -4.58884514 -15.24819830  -2.38115972  -0.25679304   2.98073732 
##          190          191          192          193          194 
##   2.42720484  -2.91315866  -2.62265518  -2.35113345   1.34152472 
##          195          196          197          198          199 
##   4.09477184  -4.96809162   6.99136215  -7.28679215  -5.94279767 
##          200          201          202          203          204 
##  -8.45594769  -2.75349781   0.57983211  -5.24033542  -0.44378910 
##          205          206          207          208          209 
##   4.71141192  15.52473566   0.86878183  -0.67780446  -3.29929234 
##          210          211          212          213          214 
##   1.48430209 -12.30380191   0.10471054  11.59917493  -5.56228876 
##          215          216          217          218          219 
##  -4.04898549   7.34166794  -5.73668179  -1.10107528   0.65290860 
##          220          221          222          223          224 
##  -0.68168001  -8.56414275  -3.33618425   0.74701985   3.90573485 
##          225          226          227          228          229 
##  -5.91195898  -0.15433057   2.85141680  -8.06123700  -3.23102236 
##          230          231          232          233          234 
##  -3.92266634  -4.81136818  -3.60455357  -1.14637545 -10.85405585 
##          235          236          237          238          239 
##  -7.83676238  -1.33583131   9.77210741   5.14096871   7.83141816 
##          240          241          242          243          244 
##  -9.32584081   2.80064751  -5.38354058  -0.81060928  -1.53289079 
##          245          246          247          248          249 
##   3.90275345   6.84717735   0.19897530   5.79082264   2.49473836 
##          250          251          252          253          254 
##  -1.22742324  -1.13717536  -0.47178315  -2.61858699  -0.46204072 
##          255          256          257          258          259 
##  -8.36243880  -0.72013731  -3.89189385   6.52517363   6.18119490 
##          260          261          262          263          264 
##  -3.26334161  -2.24277972  -2.58990072  -7.87341041  -4.26731796 
##          265          266          267          268          269 
##  -3.33679476   5.23580083  -5.93816940  -1.91436780  -1.99138453 
##          270          271          272          273          274 
##  -3.78560373  12.13980895  -1.08135616   1.00239209   1.96035713 
##          275          276          277          278          279 
##  -2.62582586  30.38675257  10.28853785  -5.84916965   3.42944816 
##          280          281          282          283          284 
##  14.95820920  -2.60744976   1.03521929  -6.18904302  -5.32846905 
##          285          286          287          288          289 
##  13.45694250  -5.76072471  19.53876261  -2.58688178  -2.97087469 
##          290          291          292          293          294 
##   0.36162116  -7.83038399   5.57241291  -3.77778376   0.44054375 
##          295          296          297          298          299 
##  -1.45428460  -0.36404758 -10.95331462   1.39384545  -5.81042198 
##          300          301          302          303          304 
##   7.05685184  -7.04636271   2.51746594   3.12038977  -4.37642723 
##          305          306          307          308          309 
##  -1.39861662  -5.28514678   8.16894811  -3.71341738  -0.38483866 
##          310          311          312          313          314 
##  11.62391992  -2.60127504  -4.95134629  -5.20890298   6.57097843 
##          315          316          317          318          319 
##   6.71617840  -5.37278897   5.30441073  -4.58823495   1.10500046 
##          320          321          322          323          324 
##   5.41096043   7.01920676  -2.22747850   7.80280858   9.36404321 
##          325          326          327          328          329 
##  -0.89671135  -1.52429457   2.77891150  -8.58054356  -3.04228562 
##          330          331          332          333          334 
##   0.48257327  -1.47053285  -0.61904708   4.92441214   0.35713766 
##          335          336          337          338          339 
##   2.79937698  -3.30305859   3.65069198   3.66197487  -3.64905439 
##          340          341          342          343          344 
##   0.70332142   2.45305804  -3.82264755  25.23029508  -3.49814291 
##          345          346          347          348          349 
##  -1.66415665   0.80927854  12.33317867   1.82675922   3.53309389 
##          350          351          352          353          354 
##  -6.10836352  -6.12231464  -5.65110314   3.08537564  -7.31676116 
##          355          356          357          358          359 
##   5.91187684  -1.53232914   7.51424359  -4.67450918  -3.89999154 
##          360          361          362          363          364 
##   1.37888580  -5.03137537   2.07323074  -1.48019261  -2.65319716 
##          365          366          367          368          369 
##   0.03896715   3.85094919  -2.07162969  -4.97106848  -3.54004451 
##          370          371          372          373          374 
##   0.16734811   5.83854959  -5.59275502   3.74696428  -4.95593970 
##          375          376          377          378          379 
##  -0.84342595   1.66162880  -7.34743913  18.61608706   7.89932189 
##          380          381          382          383          384 
##  -6.22803254  -1.45969422  -2.88248354   7.33131419   3.52270342 
##          385          386          387          388          389 
##   1.00059950  -4.17186038  20.63990170   0.18273451  -3.07711510 
##          390          391          392          393          394 
##   1.89806192   1.18061662  -8.06053071  -4.21895763   4.33505627 
##          395          396          397          398          399 
##   2.05581136  -0.23828524  -5.64787597  -0.52549764  10.13162820 
##          400          401          402          403          404 
##   2.70870270   0.80599513   3.09485726   9.44008218  -4.20521659 
##          405          406          407          408          409 
##  -1.78149259  -0.21946582  -0.30544192  -0.70022148   3.92942272 
##          410          411          412          413          414 
##   4.75617587  -1.14509821  -5.36632715  -8.62467055   3.73934592 
##          415          416          417          418          419 
##  -9.55986954  -4.78015855   7.23752584  -6.15867791  -0.77307067 
##          420          421          422          423          424 
##  14.84905353  -2.83484094  -1.96983633 -12.39378783  11.37789905 
##          425          426          427          428          429 
## -12.33422163  -2.24621628  -3.79152480   5.93535509  -3.48007849 
##          430          431          432          433          434 
##  -6.87388577   5.00900237  -6.12465520  -6.36897194   1.31495463 
##          435          436          437          438          439 
##  -2.55775019  -1.88555326  -5.92023755  -5.04463351  -2.19686730 
##          440          441          442          443          444 
##  -1.35603152   5.76406870  -7.98729143  -3.75292272  -3.76286453 
##          445          446          447          448          449 
##  -2.44203484  -2.50768986  -2.41508169  -0.08137665  16.97409920 
##          450          451          452          453          454 
##  -1.46139041   2.09172466  19.84637172   5.22387869   9.16468284 
##          455          456          457          458          459 
##  -2.56056963  -7.57977064  -4.80955878  -2.70419646   2.97294912 
##          460          461          462          463          464 
##  -0.11218890   5.79703262   1.49552949  -4.85522063  -5.18923285 
##          465          466          467          468          469 
##  -2.09890058  -3.27680552   2.84551165  -3.82762149   6.89887738 
##          470          471          472          473          474 
##  -3.97474611  14.42447459   0.09524712  -3.20217783  -1.44320763 
##          475          476          477          478          479 
##   8.38551942   1.62058890   5.49853286   6.61970670   0.23284493 
##          480          481          482          483          484 
##   1.08711959   1.43430136   0.77534659   2.16137164   2.55847642 
##          485          486          487          488          489 
##  -6.29885478   3.60511213   5.24643638   1.78845091   8.82558856 
##          490          491          492          493          494 
##  -0.61566352   3.21957627  -2.92681517   2.81264408   3.67866220 
##          495          496          497          498          499 
##   0.25226950  -4.72464675  -2.29751609  -4.65025081   5.09558822 
##          500          501          502          503          504 
##   9.43764544   3.52263201  -1.09284617  -8.19270966  -5.01653537 
##          505          506          507          508          509 
##  -6.87265305  -7.07193467  -7.66852200   1.64263375   5.91480537 
##          510          511          512          513          514 
##   3.77091851   1.66094087   1.30521383 -13.20095511 -13.44405830 
##          515          516          517          518          519 
##  -9.76512240  -6.08935066  -4.38229474 -11.02380645   6.67890532 
##          520          521          522          523          524 
##   6.13695927 -12.30924293   2.94380448  -1.45476191   3.15748105 
##          525          526          527          528          529 
##  -2.97514508   7.04584954  -0.43718193  -2.41254367   1.43078544 
##          530          531          532          533          534 
##   5.80181269  -2.79608211  -3.27995965   5.14553689  -9.21211428 
##          535          536          537          538          539 
##   0.16634531   6.14820239  17.38765571  -4.90832799   7.86847163 
##          540          541          542          543          544 
##  -5.71345233   1.00762424   1.65525095  -4.32357583   3.18975816 
##          545          546          547          548          549 
##  -2.91018261   8.62308948  12.11813247  -7.98941796  -2.75528345 
##          550          551          552          553          554 
##   3.14324226  -7.72310534   4.98367370   1.05291262  -4.24317133 
##          555          556          557          558          559 
##  -1.86417131  10.83876755  -2.60278763   0.50955763  -5.34451106 
##          560          561          562          563          564 
##  -5.26303671   1.86443971  -0.57929254   0.21856885   0.11693719 
##          565          566          567          568          569 
##   3.08206378  -2.70971136  -7.00071943  -3.89188075   0.76280170 
##          570          571          572          573          574 
##  -2.50838203  -0.74176716  -4.48531770  -2.30092342  -2.20751794 
##          575          576          577          578          579 
##   2.58326612   4.01392966  -1.18020677  -8.51409842   4.09415204 
##          580          581          582          583          584 
##  -9.21637262  -1.61596072  -7.30528082   8.76915487  -1.93026012 
##          585          586          587          588          589 
##   3.22506567  -1.55799455  -7.93591513  -3.74467036  -4.13206371 
##          590          591          592          593          594 
##  -1.70004185  -0.50912299  -7.97334507  -7.28098065  -3.52262542 
##          595          596          597          598          599 
##  -3.06261193  -4.20266964  -7.69957645  -3.48923453  -9.36829597 
##          600          601          602          603          604 
##  -4.19944594   1.62282820  -3.07118507  -8.88721289   0.24295514 
##          605          606          607          608          609 
##   4.64415776  22.47026811  -2.97834273  -2.62293992  -7.99141355 
##          610          611          612          613          614 
##  -4.87884924 -11.34320963  -1.75057724  -0.12958133 -10.85559190 
##          615          616          617          618          619 
##  15.99840162  21.15598957 -12.67122692  -9.46156635  -7.64725876 
##          620          621          622          623          624 
##   4.07883740   4.28564373   9.51080365   5.76608890  -8.24973742 
##          625          626          627          628          629 
##   0.97866765   7.74273033  -4.92746291   3.51539246  -5.28668077 
##          630          631          632          633          634 
##  -3.99359728  -1.88191041   5.20320341   4.03621020  -4.57510869 
##          635          636          637          638          639 
##  -0.94922890  -2.29671275  13.08201507  -3.47807459   5.51172664 
##          640          641          642          643          644 
##  -3.81785911  -6.17076272 -11.57820109   1.47619608   8.11253253 
##          645          646          647          648          649 
##  -6.25399777 -10.12616993   4.18568275  -2.93037039  -6.41234051 
##          650          651          652          653          654 
##  -1.10775529   2.65419419   5.33370442  -7.81666213  -4.47415150 
##          655          656          657          658          659 
##   1.75948163  -2.90620268  33.92500128  -6.61647026   3.22974177 
##          660          661          662          663          664 
##  -1.88496123  -5.10702626  -5.03697389   7.39039508   2.83585025 
##          665          666          667          668          669 
##  10.80649693  -5.31050144  -2.51463104  -1.78649004  -2.68992564 
##          670          671          672          673          674 
##   2.21137292  -7.53959164   1.50650767  -6.75562155   0.56058297 
##          675          676          677          678          679 
##   4.37514533   7.39630796 -14.43299785  -0.11734844  -8.05101329 
##          680          681          682          683          684 
##  13.27944125   2.85521137   7.98112197   3.15787302   2.15773013 
##          685          686          687          688          689 
##   8.86286493  -0.46043406   2.04622225   5.15787054  -3.56593886 
##          690          691          692          693          694 
##   5.69298963  -3.47823731  -1.90909838  -7.82031325  -6.14473593 
##          695          696          697          698          699 
##  14.64925720  -0.87716503  -1.90124193  -0.80290510   8.93205116 
##          700          701          702          703          704 
##  -5.49349497  12.21263155  -0.22517875   9.94804842  -5.71815130 
##          705          706          707          708          709 
##   4.86626269  -3.97478875  -5.01997185   4.44147826   3.44373219 
##          710          711          712          713          714 
##  -3.09977067  -1.98779525  -0.89095008   0.73554226   5.64905068 
##          715          716          717          718          719 
##  17.40545011  -1.08950039  17.60743098  -6.10139135   1.69022079 
##          720          721          722          723          724 
##  -5.54610786  -7.04628717   5.94693373   8.82401653   1.73929388 
##          725          726          727          728          729 
##  -1.94799848   7.59255265  -3.33438456  -3.33965468  12.00951146 
##          730          731          732          733          734 
##  -6.40131754   3.29242775  18.24352785  10.84788553  -4.92596208 
##          735          736          737          738          739 
##  18.01307895  -2.09266309   2.95240627   1.78457637   1.18927029 
##          740          741          742          743          744 
##   3.06104087  -3.88004379  -3.91411468  -8.23432720  11.76279247 
##          745          746          747          748          749 
##  14.86572548   3.94575471  -3.56873218  -2.35760169   1.76822761 
##          750          751          752          753 
##   5.11105148  -1.68986952  11.68366074  -5.41929514</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">target.sar.model.residuals &lt;-<span class="st"> </span>target.sar.model<span class="op">$</span>residuals</a>
<a class="sourceLine" id="cb33-2" title="2"></a>
<a class="sourceLine" id="cb33-3" title="3">target.sar.model.class_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.sar.model.residuals, </a>
<a class="sourceLine" id="cb33-4" title="4">                                            <span class="dt">n =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb33-5" title="5">                                            <span class="dt">style =</span> <span class="st">&quot;fixed&quot;</span>,</a>
<a class="sourceLine" id="cb33-6" title="6">                                            <span class="dt">fixedBreaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">25</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">50</span>),</a>
<a class="sourceLine" id="cb33-7" title="7">                                            <span class="dt">rtimes =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-8" title="8"></a>
<a class="sourceLine" id="cb33-9" title="9">cols.sar &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.sar.model.class_fx, pal)</a>
<a class="sourceLine" id="cb33-10" title="10"></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.sar, <span class="dt">main =</span> <span class="st">&quot;SAR Model&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb33-12" title="12"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.sar, <span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb33-13" title="13">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.sar, <span class="st">&quot;table&quot;</span>)), <span class="dt">title =</span> <span class="st">&quot;Residuals from SAR Model&quot;</span>,</a>
<a class="sourceLine" id="cb33-14" title="14">       <span class="dt">ncol =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_2-2.png" width="100%" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">moran.test</span>(target.sar.model.residuals, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.sar.model.residuals  
## weights: lw    
## 
## Moran I statistic standard deviate = -1.4436, p-value = 0.9256
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      -0.033524927      -0.001328021       0.000497461</code></pre>
<hr />
</div>
<div id="pergunta-3" class="section level1">
<h1>Pergunta 3</h1>
<p>Para essa variável que você escolheu, o modelo espacial SAR apresentou ganhos significantes com relação ao modelo linear simples? Justifique sua resposta.</p>
<p>Obs: Sugere-se fazer essa atividade no GeoDA ou no R.</p>
<p><strong>Reposta</strong></p>
<p>Sim, o R-squared aumentou de 0.2522 no modelo de regressão linear simples para 0.331410 no modelo de regressão espacial, conforme saída do GeoDa da figura abaixo.</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/ldaniel/Spatial-Statistics/master/images/saida_geoda_rsquared_sar.png" alt="Saída do GeoDa para o R-squared da regressão espacial (SAR)." />
<p class="caption">Saída do GeoDa para o R-squared da regressão espacial (SAR).</p>
</div>
<hr />
</div>
<div id="pergunta-4" class="section level1">
<h1>Pergunta 4</h1>
<p>Implemente a regressão espacial GWR da variável Indice95 (índice de criminalidade em 1995 de Minas Gerais) a partir de apenas uma variável independente (não pode ser Indice94, Codmuni, ID, X_coord nem Y_coord). Apresente o resultado da regressão linear simples e da regressão linear espacial por GWR. Apresente medidas da distribuição dos coeficientes (min, Q1, Q2, Q3, máx), e da distribuição do R2 (min, Q1, Q2, Q3, máx) e apresente os resultados globais da regressão (R2 global, basicamente).</p>
<p>Obs: Sugere-se fazer essa atividade no ArcGIS ou no R.</p>
<p><strong>Resposta</strong></p>
<p>Calculando o R-Squared global conforme demonstrado na Listagem 7, temos como resultado 0.4814094.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># initial setup</span></a>
<a class="sourceLine" id="cb36-2" title="2">res.palette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;green&quot;</span>), </a>
<a class="sourceLine" id="cb36-3" title="3">                                <span class="dt">space =</span> <span class="st">&quot;rgb&quot;</span>)</a>
<a class="sourceLine" id="cb36-4" title="4">pal &lt;-<span class="st"> </span><span class="kw">res.palette</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb36-5" title="5"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb36-6" title="6"></a>
<a class="sourceLine" id="cb36-7" title="7">coords &lt;-<span class="st"> </span><span class="kw">cbind</span>(target<span class="op">$</span>X_COORD, target<span class="op">$</span>Y_COORD)</a>
<a class="sourceLine" id="cb36-8" title="8"></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co"># GWR model (Geographically Weighted Regression)</span></a>
<a class="sourceLine" id="cb36-10" title="10">target.gwr.sel &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(INDICE95 <span class="op">~</span><span class="st"> </span>URBLEVEL, </a>
<a class="sourceLine" id="cb36-11" title="11">                          <span class="dt">data =</span> target, </a>
<a class="sourceLine" id="cb36-12" title="12">                          <span class="dt">coords =</span> coords, </a>
<a class="sourceLine" id="cb36-13" title="13">                          <span class="dt">adapt =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb36-14" title="14">                          <span class="dt">method =</span> <span class="st">&quot;aic&quot;</span>,</a>
<a class="sourceLine" id="cb36-15" title="15">                          <span class="dt">gweight =</span> gwr.Gauss,</a>
<a class="sourceLine" id="cb36-16" title="16">                          <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in gwr.sel(INDICE95 ~ URBLEVEL, data = target, coords = coords, :
## data is Spatial* object, ignoring coords argument</code></pre>
<pre><code>## Bandwidth: 0.381966 AIC: 5017.817 
## Bandwidth: 0.618034 AIC: 5027.177 
## Bandwidth: 0.236068 AIC: 5008.315 
## Bandwidth: 0.145898 AIC: 4996.376 
## Bandwidth: 0.09016994 AIC: 4981.971 
## Bandwidth: 0.05572809 AIC: 4963.404 
## Bandwidth: 0.03444185 AIC: 4947.969 
## Bandwidth: 0.02128624 AIC: 4934.988 
## Bandwidth: 0.01315562 AIC: 4922.911 
## Bandwidth: 0.008130619 AIC: 4929.46 
## Bandwidth: 0.01371737 AIC: 4924.275 
## Bandwidth: 0.01161865 AIC: 4923.98 
## Bandwidth: 0.01256855 AIC: 4923.31 
## Bandwidth: 0.01293138 AIC: 4923.018 
## Bandwidth: 0.01337019 AIC: 4923.218 
## Bandwidth: 0.01309826 AIC: 4922.933 
## Bandwidth: 0.01323758 AIC: 4922.884 
## Bandwidth: 0.01328823 AIC: 4922.959 
## Bandwidth: 0.01319689 AIC: 4922.897 
## Bandwidth: 0.01323758 AIC: 4922.884</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">target.gwr.model &lt;-<span class="st"> </span><span class="kw">gwr</span>(INDICE95 <span class="op">~</span><span class="st"> </span>URBLEVEL, </a>
<a class="sourceLine" id="cb39-2" title="2">                        <span class="dt">data =</span> target, </a>
<a class="sourceLine" id="cb39-3" title="3">                        <span class="dt">coords =</span> coords, </a>
<a class="sourceLine" id="cb39-4" title="4">                        <span class="dt">bandwidth =</span> target.gwr.sel,</a>
<a class="sourceLine" id="cb39-5" title="5">                        <span class="dt">gweight =</span> gwr.Gauss,</a>
<a class="sourceLine" id="cb39-6" title="6">                        <span class="dt">adapt =</span> target.gwr.sel,</a>
<a class="sourceLine" id="cb39-7" title="7">                        <span class="dt">hatmatrix =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in gwr(INDICE95 ~ URBLEVEL, data = target, coords = coords,
## bandwidth = target.gwr.sel, : data is Spatial* object, ignoring coords
## argument</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">summary</span>(target.gwr.model)</a></code></pre></div>
<pre><code>##           Length Class                    Mode     
## SDF          754 SpatialPolygonsDataFrame S4       
## lhat      568516 -none-                   numeric  
## lm            11 -none-                   list     
## results       14 -none-                   list     
## bandwidth    754 -none-                   numeric  
## adapt          1 -none-                   numeric  
## hatmatrix      1 -none-                   logical  
## gweight        1 -none-                   character
## gTSS           1 -none-                   numeric  
## this.call      8 -none-                   call     
## fp.given       1 -none-                   logical  
## timings       12 -none-                   numeric</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># calculate global residual SST (SQT)</span></a>
<a class="sourceLine" id="cb43-2" title="2">SST &lt;-<span class="st"> </span><span class="kw">sum</span>((target<span class="op">$</span>INDICE95 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(target<span class="op">$</span>INDICE95)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-3" title="3">GWR_SSE &lt;-<span class="st"> </span>target.gwr.model<span class="op">$</span>results<span class="op">$</span>rss</a>
<a class="sourceLine" id="cb43-4" title="4">r2_GWR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(GWR_SSE <span class="op">/</span><span class="st"> </span>SST)</a>
<a class="sourceLine" id="cb43-5" title="5">r2_GWR</a></code></pre></div>
<pre><code>## [1] 0.4814094</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># residuals</span></a>
<a class="sourceLine" id="cb45-2" title="2">target.gwr.residuals &lt;-<span class="st"> </span>target.gwr.model<span class="op">$</span>SDF<span class="op">$</span>gwr.e</a>
<a class="sourceLine" id="cb45-3" title="3"></a>
<a class="sourceLine" id="cb45-4" title="4">target.gwr.residuals.classes_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.gwr.residuals, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">style =</span> <span class="st">&quot;fixed&quot;</span>, </a>
<a class="sourceLine" id="cb45-5" title="5">                                                  <span class="dt">fixedBreaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">25</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">50</span>), </a>
<a class="sourceLine" id="cb45-6" title="6">                                                  <span class="dt">rtimes =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb45-7" title="7">cols.gwr.residuals &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.gwr.residuals.classes_fx, pal)</a>
<a class="sourceLine" id="cb45-8" title="8"></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.gwr.residuals, <span class="dt">main =</span> <span class="st">&quot;GWR Model (residuals)&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb45-10" title="10"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.gwr.residuals,<span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb45-11" title="11">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.gwr.residuals, <span class="st">&quot;table&quot;</span>)), </a>
<a class="sourceLine" id="cb45-12" title="12">       <span class="dt">title =</span> <span class="st">&quot;Residuals from GWR Model&quot;</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_4-1.png" width="100%" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">moran.test</span>(target.gwr.residuals, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.gwr.residuals  
## weights: lw    
## 
## Moran I statistic standard deviate = -0.80775, p-value = 0.7904
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##     -0.0193493816     -0.0013280212      0.0004977648</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># coefficients</span></a>
<a class="sourceLine" id="cb48-2" title="2">target.gwr.coefficients &lt;-<span class="st"> </span>target.gwr.model<span class="op">$</span>SDF<span class="op">$</span>URBLEVEL</a>
<a class="sourceLine" id="cb48-3" title="3"></a>
<a class="sourceLine" id="cb48-4" title="4">target.gwr.coefficients.classes_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.gwr.coefficients, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">style =</span> <span class="st">&quot;fixed&quot;</span>, </a>
<a class="sourceLine" id="cb48-5" title="5">                                                     <span class="dt">fixedBreaks=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">005</span>,<span class="op">-</span>.<span class="dv">003</span>,<span class="op">-</span>.<span class="dv">001</span>,.<span class="dv">001</span>,.<span class="dv">003</span>,.<span class="dv">005</span>), </a>
<a class="sourceLine" id="cb48-6" title="6">                                                     <span class="dt">rtimes =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Warning in classIntervals(target.gwr.coefficients, n = 5, style =
## &quot;fixed&quot;, : variable range greater than fixedBreaks</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">cols.gwr.coefficients &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.gwr.coefficients.classes_fx, pal)</a>
<a class="sourceLine" id="cb50-2" title="2"></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.gwr.coefficients, <span class="dt">main =</span> <span class="st">&quot;GWR Model (coefficients)&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb50-4" title="4"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.gwr.coefficients,<span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb50-5" title="5">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.gwr.coefficients, <span class="st">&quot;table&quot;</span>)),</a>
<a class="sourceLine" id="cb50-6" title="6">       <span class="dt">title =</span> <span class="st">&quot;Local Coefficient Estimates (URBLEVEL)&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_4-2.png" width="100%" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">moran.test</span>(target.gwr.coefficients, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.gwr.coefficients  
## weights: lw    
## 
## Moran I statistic standard deviate = 41.759, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.9315389337     -0.0013280212      0.0004990371</code></pre>
<hr />
</div>
<div id="pergunta-5" class="section level1">
<h1>Pergunta 5</h1>
<p>Para essa variável que você escolheu, o modelo espacial GWR apresentou ganhos significantes com relação ao modelo linear simples? Justifique sua resposta.</p>
<p><strong>Resposta</strong></p>
<p>Sim, o R-squared aumentou de 0.2522 no modelo de regressão linear simples para 0.4814094 no modelo GWR.</p>
<hr />
</div>
<div id="pergunta-6" class="section level1">
<h1>Pergunta 6</h1>
<p>Implemente um modelo de regressão linear multivariado stepwise da variável Indice95 (significante a 5% ou 10%, utilize o que achar melhor). Depois, “promova-o” a um modelo SAR. Apresente os resultados comparados (equação, <span class="math inline">\(R^{2}\)</span>). Qual modelo você escolheria como final? Se desejar, apresente mapas que sustente sua justificativa.</p>
<p><strong>Resposta</strong></p>
<p>Os valores de <span class="math inline">\(R^{2}\)</span>, são:</p>
<ul>
<li>SAR <span class="math inline">\(R^{2}\)</span>: 0.7052</li>
<li>LM com stepwise <span class="math inline">\(R^{2}\)</span>: 0.6982</li>
</ul>
<p>Escolheríamos o com o maior <span class="math inline">\(R^{2}\)</span>, ou seja, o SAR. Baseado nos mapas e comparando os valores previstos contra os reais, podemos ver que a distribuição do modelo se aproxima adequadamente dos valores observados em cada distrito.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># initial exploration in INDICE95 x AREA</span></a>
<a class="sourceLine" id="cb53-2" title="2">indice95_by_urblevel_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> target<span class="op">@</span>data, </a>
<a class="sourceLine" id="cb53-3" title="3">                                    <span class="kw">aes</span>(<span class="dt">x =</span> target<span class="op">$</span>INDICE95, </a>
<a class="sourceLine" id="cb53-4" title="4">                                        <span class="dt">y =</span> target<span class="op">$</span>URBLEVEL, </a>
<a class="sourceLine" id="cb53-5" title="5">                                        <span class="dt">color =</span> target<span class="op">$</span>URBLEVEL)) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb53-7" title="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-8" title="8"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;INDICE95&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-9" title="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;AREA&quot;</span>)</a>
<a class="sourceLine" id="cb53-10" title="10"></a>
<a class="sourceLine" id="cb53-11" title="11"><span class="kw">ggMarginal</span>(indice95_by_urblevel_plot, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_6-1.png" width="100%" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># runing the linear model multivaluated and looking at the residuals</span></a>
<a class="sourceLine" id="cb54-2" title="2">target.ols.model &lt;-<span class="st"> </span><span class="kw">lm</span>(INDICE95 <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="st">                         </span>AREA <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="st">                         </span>INDICE94 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="st">                         </span>GINI_<span class="dv">91</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="st">                         </span>POP_<span class="dv">94</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="st">                         </span>POP_RUR <span class="op">+</span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="st">                         </span>POP_URB <span class="op">+</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="st">                         </span>POP_FEM <span class="op">+</span></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="st">                         </span>POP_MAS <span class="op">+</span></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="st">                         </span>POP_TOT <span class="op">+</span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="st">                         </span>URBLEVEL <span class="op">+</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="st">                         </span>PIB_PC, </a>
<a class="sourceLine" id="cb54-14" title="14">                       <span class="dt">data =</span> target)</a>
<a class="sourceLine" id="cb54-15" title="15"></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="kw">summary</span>(target.ols.model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = INDICE95 ~ AREA + INDICE94 + GINI_91 + POP_94 + 
##     POP_RUR + POP_URB + POP_FEM + POP_MAS + POP_TOT + URBLEVEL + 
##     PIB_PC, data = target)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.2474  -2.5079  -0.1905   2.3087  29.0575 
## 
## Coefficients: (2 not defined because of singularities)
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.399e+00  7.464e-01   5.894 5.71e-09 ***
## AREA        -2.434e-05  1.657e-04  -0.147 0.883256    
## INDICE94     8.260e-01  2.668e-02  30.956  &lt; 2e-16 ***
## GINI_91     -5.717e+00  1.666e+00  -3.432 0.000633 ***
## POP_94      -7.998e-05  6.787e-05  -1.178 0.238994    
## POP_RUR      3.353e-04  2.404e-04   1.395 0.163519    
## POP_URB      3.398e-04  2.720e-04   1.250 0.211863    
## POP_FEM     -4.911e-04  4.362e-04  -1.126 0.260650    
## POP_MAS             NA         NA      NA       NA    
## POP_TOT             NA         NA      NA       NA    
## URBLEVEL     4.873e+00  1.113e+00   4.380 1.36e-05 ***
## PIB_PC       9.472e-05  6.519e-05   1.453 0.146643    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.356 on 744 degrees of freedom
## Multiple R-squared:  0.7004, Adjusted R-squared:  0.6967 
## F-statistic: 193.2 on 9 and 744 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">target<span class="op">$</span>resid &lt;-<span class="st"> </span><span class="kw">residuals</span>(target.ols.model)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">spplot</span>(target, <span class="st">&quot;resid&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Residuals&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_6-2.png" width="100%" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># runing the lm multivaluated model</span></a>
<a class="sourceLine" id="cb57-2" title="2">target.lm.multivaluated.model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span>INDICE95 <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">                                      </span>AREA <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="st">                                      </span>INDICE94 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="st">                                      </span>GINI_<span class="dv">91</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="st">                                      </span>POP_<span class="dv">94</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="st">                                      </span>POP_RUR <span class="op">+</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="st">                                      </span>POP_URB <span class="op">+</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="st">                                      </span>POP_FEM <span class="op">+</span></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="st">                                      </span>POP_MAS <span class="op">+</span></a>
<a class="sourceLine" id="cb57-11" title="11"><span class="st">                                      </span>POP_TOT <span class="op">+</span></a>
<a class="sourceLine" id="cb57-12" title="12"><span class="st">                                      </span>URBLEVEL <span class="op">+</span></a>
<a class="sourceLine" id="cb57-13" title="13"><span class="st">                                      </span>PIB_PC, </a>
<a class="sourceLine" id="cb57-14" title="14">                                    <span class="dt">data =</span> target)</a>
<a class="sourceLine" id="cb57-15" title="15"></a>
<a class="sourceLine" id="cb57-16" title="16"><span class="kw">summary</span>(target.lm.multivaluated.model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = INDICE95 ~ AREA + INDICE94 + GINI_91 + POP_94 + 
##     POP_RUR + POP_URB + POP_FEM + POP_MAS + POP_TOT + URBLEVEL + 
##     PIB_PC, data = target)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.2474  -2.5079  -0.1905   2.3087  29.0575 
## 
## Coefficients: (2 not defined because of singularities)
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.399e+00  7.464e-01   5.894 5.71e-09 ***
## AREA        -2.434e-05  1.657e-04  -0.147 0.883256    
## INDICE94     8.260e-01  2.668e-02  30.956  &lt; 2e-16 ***
## GINI_91     -5.717e+00  1.666e+00  -3.432 0.000633 ***
## POP_94      -7.998e-05  6.787e-05  -1.178 0.238994    
## POP_RUR      3.353e-04  2.404e-04   1.395 0.163519    
## POP_URB      3.398e-04  2.720e-04   1.250 0.211863    
## POP_FEM     -4.911e-04  4.362e-04  -1.126 0.260650    
## POP_MAS             NA         NA      NA       NA    
## POP_TOT             NA         NA      NA       NA    
## URBLEVEL     4.873e+00  1.113e+00   4.380 1.36e-05 ***
## PIB_PC       9.472e-05  6.519e-05   1.453 0.146643    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.356 on 744 degrees of freedom
## Multiple R-squared:  0.7004, Adjusted R-squared:  0.6967 
## F-statistic: 193.2 on 9 and 744 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># performing the stepwise selection</span></a>
<a class="sourceLine" id="cb59-2" title="2">target.sar.model.stepwise &lt;-<span class="st"> </span><span class="kw">step</span>(target.lm.multivaluated.model, </a>
<a class="sourceLine" id="cb59-3" title="3">                                       <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb59-4" title="4">                                       <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=2229.04
## INDICE95 ~ AREA + INDICE94 + GINI_91 + POP_94 + POP_RUR + POP_URB + 
##     POP_FEM + POP_MAS + POP_TOT + URBLEVEL + PIB_PC
## 
## 
## Step:  AIC=2229.04
## INDICE95 ~ AREA + INDICE94 + GINI_91 + POP_94 + POP_RUR + POP_URB + 
##     POP_FEM + POP_MAS + URBLEVEL + PIB_PC
## 
## 
## Step:  AIC=2229.04
## INDICE95 ~ AREA + INDICE94 + GINI_91 + POP_94 + POP_RUR + POP_URB + 
##     POP_FEM + URBLEVEL + PIB_PC
## 
##            Df Sum of Sq   RSS    AIC  F value    Pr(&gt;F)    
## - AREA      1       0.4 14118 2227.1   0.0216 0.8832559    
## - POP_FEM   1      24.0 14141 2228.3   1.2672 0.2606497    
## - POP_94    1      26.4 14144 2228.4   1.3887 0.2389944    
## - POP_URB   1      29.6 14147 2228.6   1.5613 0.2118628    
## - POP_RUR   1      36.9 14154 2229.0   1.9452 0.1635185    
## &lt;none&gt;                  14117 2229.0                       
## - PIB_PC    1      40.1 14157 2229.2   2.1112 0.1466430    
## - GINI_91   1     223.5 14341 2238.9  11.7767 0.0006329 ***
## - URBLEVEL  1     364.0 14481 2246.2  19.1850 1.357e-05 ***
## - INDICE94  1   18183.4 32301 2851.1 958.2957 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2227.06
## INDICE95 ~ INDICE94 + GINI_91 + POP_94 + POP_RUR + POP_URB + 
##     POP_FEM + URBLEVEL + PIB_PC
## 
##            Df Sum of Sq   RSS    AIC  F value    Pr(&gt;F)    
## - POP_FEM   1      23.8 14141 2226.3   1.2550 0.2629536    
## - POP_94    1      26.4 14144 2226.5   1.3908 0.2386469    
## - POP_URB   1      29.4 14147 2226.6   1.5504 0.2134751    
## - POP_RUR   1      36.5 14154 2227.0   1.9274 0.1654620    
## &lt;none&gt;                  14118 2227.1                       
## - PIB_PC    1      39.7 14157 2227.2   2.0961 0.1480920    
## + AREA      1       0.4 14117 2229.0   0.0216 0.8832559    
## - GINI_91   1     223.1 14341 2236.9  11.7708 0.0006348 ***
## - URBLEVEL  1     363.7 14481 2244.2  19.1948  1.35e-05 ***
## - INDICE94  1   18381.3 32499 2853.7 970.0001 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2226.33
## INDICE95 ~ INDICE94 + GINI_91 + POP_94 + POP_RUR + POP_URB + 
##     URBLEVEL + PIB_PC
## 
##            Df Sum of Sq   RSS    AIC  F value    Pr(&gt;F)    
## - POP_URB   1       8.9 14150 2224.8   0.4716 0.4924811    
## - POP_94    1       9.5 14151 2224.8   0.4998 0.4798126    
## - POP_RUR   1      28.5 14170 2225.8   1.5033 0.2205482    
## &lt;none&gt;                  14141 2226.3                       
## - PIB_PC    1      45.6 14187 2226.8   2.4046 0.1214065    
## + POP_MAS   1      23.8 14118 2227.1   1.2550 0.2629536    
## + POP_FEM   1      23.8 14118 2227.1   1.2550 0.2629536    
## + AREA      1       0.1 14141 2228.3   0.0077 0.9299511    
## - GINI_91   1     264.8 14406 2238.3  13.9673 0.0002002 ***
## - URBLEVEL  1     489.0 14630 2250.0  25.7980 4.794e-07 ***
## - INDICE94  1   18812.2 32954 2862.2 992.4021 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2224.8
## INDICE95 ~ INDICE94 + GINI_91 + POP_94 + POP_RUR + URBLEVEL + 
##     PIB_PC
## 
##            Df Sum of Sq   RSS    AIC  F value    Pr(&gt;F)    
## - POP_94    1       6.6 14157 2223.2   0.3510 0.5537200    
## - POP_RUR   1      31.7 14182 2224.5   1.6733 0.1962143    
## &lt;none&gt;                  14150 2224.8                       
## - PIB_PC    1      45.5 14196 2225.2   2.4030 0.1215257    
## + POP_MAS   1      19.8 14131 2225.8   1.0441 0.3071898    
## + POP_URB   1       8.9 14141 2226.3   0.4716 0.4924811    
## + POP_TOT   1       8.9 14141 2226.3   0.4716 0.4924811    
## + POP_FEM   1       3.3 14147 2226.6   0.1763 0.6747080    
## + AREA      1       0.2 14150 2226.8   0.0124 0.9114553    
## - GINI_91   1     259.8 14410 2236.5  13.7147 0.0002285 ***
## - URBLEVEL  1     481.0 14631 2248.0  25.3905 5.878e-07 ***
## - INDICE94  1   18803.9 32954 2860.2 992.6648 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2223.16
## INDICE95 ~ INDICE94 + GINI_91 + POP_RUR + URBLEVEL + PIB_PC
## 
##            Df Sum of Sq   RSS    AIC   F value    Pr(&gt;F)    
## - POP_RUR   1      26.5 14183 2222.6    1.3999 0.2371164    
## &lt;none&gt;                  14157 2223.2                        
## - PIB_PC    1      42.1 14199 2223.4    2.2224 0.1364410    
## + POP_94    1       6.6 14150 2224.8    0.3510 0.5537200    
## + POP_FEM   1       6.3 14151 2224.8    0.3301 0.5657654    
## + POP_URB   1       6.1 14151 2224.8    0.3228 0.5701278    
## + POP_TOT   1       6.1 14151 2224.8    0.3228 0.5701278    
## + POP_MAS   1       6.0 14151 2224.8    0.3146 0.5750348    
## + AREA      1       0.1 14157 2225.2    0.0056 0.9402033    
## - GINI_91   1     254.5 14411 2234.6   13.4449 0.0002631 ***
## - URBLEVEL  1     474.6 14632 2246.0   25.0782 6.873e-07 ***
## - INDICE94  1   19000.4 33157 2862.8 1003.9088 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2222.57
## INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL + PIB_PC
## 
##            Df Sum of Sq   RSS    AIC   F value    Pr(&gt;F)    
## - PIB_PC    1      36.5 14220 2222.5    1.9262 0.1655828    
## &lt;none&gt;                  14183 2222.6                        
## + POP_RUR   1      26.5 14157 2223.2    1.3999 0.2371164    
## + AREA      1       7.8 14176 2224.2    0.4118 0.5212786    
## + POP_URB   1       2.1 14181 2224.5    0.1104 0.7397677    
## + POP_94    1       1.4 14182 2224.5    0.0763 0.7824405    
## + POP_FEM   1       1.3 14182 2224.5    0.0660 0.7973026    
## + POP_TOT   1       1.1 14182 2224.5    0.0572 0.8110716    
## + POP_MAS   1       0.9 14183 2224.5    0.0482 0.8263674    
## - GINI_91   1     234.5 14418 2232.9   12.3841 0.0004592 ***
## - URBLEVEL  1     454.0 14637 2244.3   23.9724 1.198e-06 ***
## - INDICE94  1   19027.5 33211 2862.1 1004.8071 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Step:  AIC=2222.5
## INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL
## 
##            Df Sum of Sq   RSS    AIC   F value    Pr(&gt;F)    
## &lt;none&gt;                  14220 2222.5                        
## + PIB_PC    1      36.5 14183 2222.6    1.9262 0.1655828    
## + POP_RUR   1      20.9 14199 2223.4    1.1029 0.2939589    
## + AREA      1       7.5 14212 2224.1    0.3961 0.5292895    
## + POP_URB   1       0.7 14219 2224.5    0.0366 0.8482808    
## + POP_94    1       0.4 14220 2224.5    0.0212 0.8842963    
## + POP_FEM   1       0.3 14220 2224.5    0.0164 0.8982316    
## + POP_TOT   1       0.2 14220 2224.5    0.0122 0.9119818    
## + POP_MAS   1       0.2 14220 2224.5    0.0084 0.9271985    
## - GINI_91   1     252.2 14472 2233.8   13.3021 0.0002834 ***
## - URBLEVEL  1     550.7 14771 2249.2   29.0476 9.466e-08 ***
## - INDICE94  1   19206.1 33426 2864.9 1012.9869 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">summary</span>(target.sar.model.stepwise)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL, data = target)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.6372  -2.4362  -0.2178   2.3819  29.1584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.62004    0.72718   6.353 3.65e-10 ***
## INDICE94     0.82950    0.02606  31.827  &lt; 2e-16 ***
## GINI_91     -5.80519    1.59168  -3.647 0.000283 ***
## URBLEVEL     5.33462    0.98980   5.390 9.47e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.354 on 750 degrees of freedom
## Multiple R-squared:  0.6982, Adjusted R-squared:  0.697 
## F-statistic: 578.3 on 3 and 750 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># runing the SAR model</span></a>
<a class="sourceLine" id="cb63-2" title="2">target.lagsarlm.model &lt;-<span class="st"> </span><span class="kw">lagsarlm</span>(<span class="dt">formula =</span>INDICE95 <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="st">                                       </span>AREA <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="st">                                       </span>INDICE94 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="st">                                       </span>GINI_<span class="dv">91</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="st">                                       </span>POP_<span class="dv">94</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="st">                                       </span>POP_RUR <span class="op">+</span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="st">                                       </span>POP_URB <span class="op">+</span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="st">                                       </span>POP_FEM <span class="op">+</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="st">                                       </span>POP_MAS <span class="op">+</span></a>
<a class="sourceLine" id="cb63-11" title="11"><span class="st">                                       </span>POP_TOT <span class="op">+</span></a>
<a class="sourceLine" id="cb63-12" title="12"><span class="st">                                       </span>URBLEVEL <span class="op">+</span></a>
<a class="sourceLine" id="cb63-13" title="13"><span class="st">                                       </span>PIB_PC, </a>
<a class="sourceLine" id="cb63-14" title="14">                                     <span class="dt">data =</span> target,</a>
<a class="sourceLine" id="cb63-15" title="15">                                     <span class="dt">listw =</span> lw, </a>
<a class="sourceLine" id="cb63-16" title="16">                                     <span class="dt">quiet =</span> T)</a></code></pre></div>
<pre><code>## Warning: Function lagsarlm moved to the spatialreg package</code></pre>
<pre><code>## Warning in spatialreg::lagsarlm(formula = formula, data = data, listw =
## listw, : Aliased variables found: POP_MAS POP_TOT</code></pre>
<pre><code>## Warning in spatialreg::lagsarlm(formula = formula, data = data, listw = listw, : inversion of asymptotic covariance matrix failed for tol.solve = 1e-10 
##   reciprocal condition number = 2.73088e-13 - using numerical Hessian.</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">summary</span>(target.lagsarlm.model)</a></code></pre></div>
<pre><code>## 
## Call:spatialreg::lagsarlm(formula = formula, data = data, listw = listw, 
##     na.action = na.action, Durbin = Durbin, type = type, method = method, 
##     quiet = quiet, zero.policy = zero.policy, interval = interval, 
##     tol.solve = tol.solve, trs = trs, control = control)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -16.07734  -2.51809  -0.24251   2.24004  28.31986 
## 
## Type: lag 
## Coefficients: (numerical Hessian approximate standard errors) 
##     (2 not defined because of singularities)
##                Estimate  Std. Error z value  Pr(&gt;|z|)
## (Intercept)  3.0698e+00  8.3755e-01  3.6652 0.0002472
## AREA        -4.9289e-05  1.5683e-04 -0.3143 0.7533108
## INDICE94     8.0113e-01  2.7358e-02 29.2827 &lt; 2.2e-16
## GINI_91     -5.5320e+00  1.6387e+00 -3.3758 0.0007361
## POP_94      -7.0560e-05  6.4048e-05 -1.1017 0.2705999
## POP_RUR      2.7895e-04  2.1988e-04  1.2687 0.2045632
## POP_URB      2.5329e-04  2.4956e-04  1.0149 0.3101326
## POP_FEM     -3.4460e-04  4.0286e-04 -0.8554 0.3923408
## POP_MAS              NA          NA      NA        NA
## POP_TOT              NA          NA      NA        NA
## URBLEVEL     4.4859e+00  1.0953e+00  4.0957 4.209e-05
## PIB_PC       7.3630e-05  6.3976e-05  1.1509 0.2497718
## 
## Rho: 0.11106, LR test value: 10.748, p-value: 0.0010441
## Approximate (numerical Hessian) standard error: 0.033639
##     z-value: 3.3017, p-value: 0.00096113
## Wald statistic: 10.901, p-value: 0.00096113
## 
## Log likelihood: -2169.023 for lag model
## ML residual variance (sigma squared): 18.417, (sigma: 4.2916)
## Number of observations: 754 
## Number of parameters estimated: 12 
## AIC: 4362, (AIC for lm: 4370.8)</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># calculate global residual SST (SQT)</span></a>
<a class="sourceLine" id="cb69-2" title="2">SST &lt;-<span class="st"> </span><span class="kw">sum</span>((target<span class="op">$</span>INDICE95 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(target<span class="op">$</span>INDICE95)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-3" title="3">GWR_SSE &lt;-<span class="st"> </span>target.lagsarlm.model<span class="op">$</span>SSE</a>
<a class="sourceLine" id="cb69-4" title="4">r2_GWR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(GWR_SSE <span class="op">/</span><span class="st"> </span>SST)</a>
<a class="sourceLine" id="cb69-5" title="5">r2_GWR</a></code></pre></div>
<pre><code>## [1] 0.7052442</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># maps</span></a>
<a class="sourceLine" id="cb71-2" title="2">target<span class="op">$</span>fitted_sem &lt;-<span class="st"> </span>target.lagsarlm.model<span class="op">$</span>fitted.values</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">spplot</span>(target, <span class="st">&quot;fitted_sem&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Fitted values&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_6-3.png" width="100%" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">target<span class="op">$</span>actual_sem &lt;-<span class="st"> </span>target.lagsarlm.model<span class="op">$</span>y</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">spplot</span>(target, <span class="st">&quot;fitted_sem&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Actual values&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_6-4.png" width="100%" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">names</span>(target.sar.model.stepwise<span class="op">$</span>coefficients) &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_sub</span>(<span class="kw">names</span>(target.sar.model.stepwise<span class="op">$</span>coefficients), <span class="dv">1</span>, <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="kw">summary</span>(target.sar.model.stepwise)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL, data = target)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.6372  -2.4362  -0.2178   2.3819  29.1584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.62004    0.72718   6.353 3.65e-10 ***
## INDICE94     0.82950    0.02606  31.827  &lt; 2e-16 ***
## GINI_91     -5.80519    1.59168  -3.647 0.000283 ***
## URBLEVEL     5.33462    0.98980   5.390 9.47e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.354 on 750 degrees of freedom
## Multiple R-squared:  0.6982, Adjusted R-squared:  0.697 
## F-statistic: 578.3 on 3 and 750 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr />
</div>
<div id="pergunta-7-bonus" class="section level1">
<h1>Pergunta 7 (bônus)</h1>
<p>Promova o modelo final linear da Pergunta 6 a um modelo GWR. Apresente os resultados comparados (equação, R2). Qual modelo você escolheria como final? Se desejar, apresente mapas que sustente sua justificativa.</p>
<p><strong>Resposta</strong></p>
<p>Calculando o R-Squared global, temos como resultado 0.7473547.</p>
<p>Escolheríamos o com o maior <span class="math inline">\(R^{2}\)</span>, ou seja, o GWR stepwise. Baseado nos mapas e comparando os valores previstos contra os reais, podemos ver que a distribuição do modelo se aproxima adequadamente dos valores observados em cada distrito.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co"># initial setup</span></a>
<a class="sourceLine" id="cb75-2" title="2">res.palette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;green&quot;</span>), </a>
<a class="sourceLine" id="cb75-3" title="3">                                <span class="dt">space =</span> <span class="st">&quot;rgb&quot;</span>)</a>
<a class="sourceLine" id="cb75-4" title="4">pal &lt;-<span class="st"> </span><span class="kw">res.palette</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb75-6" title="6"></a>
<a class="sourceLine" id="cb75-7" title="7"><span class="co"># GWR model (Geographically Weighted Regression)</span></a>
<a class="sourceLine" id="cb75-8" title="8">target.gwr.multivaluated.sel &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(INDICE95 <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="st">                                          </span>INDICE94 <span class="op">+</span></a>
<a class="sourceLine" id="cb75-10" title="10"><span class="st">                                          </span>GINI_<span class="dv">91</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb75-11" title="11"><span class="st">                                          </span>URBLEVEL, </a>
<a class="sourceLine" id="cb75-12" title="12">                                          <span class="dt">data =</span> target, </a>
<a class="sourceLine" id="cb75-13" title="13">                                          <span class="dt">coords =</span> coords, </a>
<a class="sourceLine" id="cb75-14" title="14">                                          <span class="dt">adapt =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb75-15" title="15">                                          <span class="dt">method =</span> <span class="st">&quot;aic&quot;</span>,</a>
<a class="sourceLine" id="cb75-16" title="16">                                          <span class="dt">gweight =</span> gwr.Gauss,</a>
<a class="sourceLine" id="cb75-17" title="17">                                          <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in gwr.sel(INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL, data =
## target, : data is Spatial* object, ignoring coords argument</code></pre>
<pre><code>## Bandwidth: 0.381966 AIC: 4352.188 
## Bandwidth: 0.618034 AIC: 4356.921 
## Bandwidth: 0.236068 AIC: 4345.973 
## Bandwidth: 0.145898 AIC: 4337.335 
## Bandwidth: 0.09016994 AIC: 4327.284 
## Bandwidth: 0.05572809 AIC: 4316.803 
## Bandwidth: 0.03444185 AIC: 4315.656 
## Bandwidth: 0.03909335 AIC: 4314.58 
## Bandwidth: 0.04351445 AIC: 4313.698 
## Bandwidth: 0.04817964 AIC: 4314.661 
## Bandwidth: 0.04355514 AIC: 4313.686 
## Bandwidth: 0.04532154 AIC: 4313.599 
## Bandwidth: 0.04462362 AIC: 4313.572 
## Bandwidth: 0.04473981 AIC: 4313.567 
## Bandwidth: 0.0448376 AIC: 4313.563 
## Bandwidth: 0.04502245 AIC: 4313.557 
## Bandwidth: 0.04513669 AIC: 4313.563 
## Bandwidth: 0.04498176 AIC: 4313.558 
## Bandwidth: 0.04506314 AIC: 4313.556 
## Bandwidth: 0.04506314 AIC: 4313.556</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">target.gwr.multivaluated.model &lt;-<span class="st"> </span><span class="kw">gwr</span>(INDICE95 <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">                                        </span>INDICE94 <span class="op">+</span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="st">                                        </span>GINI_<span class="dv">91</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="st">                                        </span>URBLEVEL, </a>
<a class="sourceLine" id="cb78-5" title="5">                                        <span class="dt">data =</span> target, </a>
<a class="sourceLine" id="cb78-6" title="6">                                        <span class="dt">coords =</span> coords, </a>
<a class="sourceLine" id="cb78-7" title="7">                                        <span class="dt">bandwidth =</span> target.gwr.multivaluated.sel,</a>
<a class="sourceLine" id="cb78-8" title="8">                                        <span class="dt">gweight =</span> gwr.Gauss,</a>
<a class="sourceLine" id="cb78-9" title="9">                                        <span class="dt">adapt =</span> target.gwr.multivaluated.sel,</a>
<a class="sourceLine" id="cb78-10" title="10">                                        <span class="dt">hatmatrix =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in gwr(INDICE95 ~ INDICE94 + GINI_91 + URBLEVEL, data = target, :
## data is Spatial* object, ignoring coords argument</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># calculate global residual SST (SQT)</span></a>
<a class="sourceLine" id="cb80-2" title="2">SST &lt;-<span class="st"> </span><span class="kw">sum</span>((target<span class="op">$</span>INDICE95 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(target<span class="op">$</span>INDICE95)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb80-3" title="3">GWR_SSE &lt;-<span class="st"> </span>target.gwr.multivaluated.model<span class="op">$</span>results<span class="op">$</span>rss</a>
<a class="sourceLine" id="cb80-4" title="4">r2_GWR &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(GWR_SSE <span class="op">/</span><span class="st"> </span>SST)</a>
<a class="sourceLine" id="cb80-5" title="5">r2_GWR</a></code></pre></div>
<pre><code>## [1] 0.7473547</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># maps</span></a>
<a class="sourceLine" id="cb82-2" title="2">target<span class="op">$</span>fitted_sem &lt;-<span class="st"> </span>target.gwr.multivaluated.model<span class="op">$</span>lm<span class="op">$</span>fitted.values</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="kw">spplot</span>(target, <span class="st">&quot;fitted_sem&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Fitted values&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_7-1.png" width="100%" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">target<span class="op">$</span>actual_sem &lt;-<span class="st"> </span>target.gwr.multivaluated.model<span class="op">$</span>lm<span class="op">$</span>y</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">spplot</span>(target, <span class="st">&quot;fitted_sem&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Actual values&quot;</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_7-2.png" width="100%" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># residuals</span></a>
<a class="sourceLine" id="cb84-2" title="2">target.gwr.residuals &lt;-<span class="st"> </span>target.gwr.model<span class="op">$</span>SDF<span class="op">$</span>gwr.e</a>
<a class="sourceLine" id="cb84-3" title="3"></a>
<a class="sourceLine" id="cb84-4" title="4">target.gwr.residuals.classes_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.gwr.residuals, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">style =</span> <span class="st">&quot;fixed&quot;</span>, </a>
<a class="sourceLine" id="cb84-5" title="5">                                                  <span class="dt">fixedBreaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">25</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">25</span>,<span class="dv">50</span>), </a>
<a class="sourceLine" id="cb84-6" title="6">                                                  <span class="dt">rtimes =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-7" title="7">cols.gwr.residuals &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.gwr.residuals.classes_fx, pal)</a>
<a class="sourceLine" id="cb84-8" title="8"></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.gwr.residuals, <span class="dt">main =</span> <span class="st">&quot;GWR Model (residuals)&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb84-10" title="10"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.gwr.residuals,<span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb84-11" title="11">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.gwr.residuals, <span class="st">&quot;table&quot;</span>)), </a>
<a class="sourceLine" id="cb84-12" title="12">       <span class="dt">title =</span> <span class="st">&quot;Residuals from GWR Model&quot;</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_7-3.png" width="100%" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">moran.test</span>(target.gwr.residuals, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.gwr.residuals  
## weights: lw    
## 
## Moran I statistic standard deviate = -0.80775, p-value = 0.7904
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##     -0.0193493816     -0.0013280212      0.0004977648</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># coefficients</span></a>
<a class="sourceLine" id="cb87-2" title="2">target.gwr.coefficients &lt;-<span class="st"> </span>target.gwr.model<span class="op">$</span>SDF<span class="op">$</span>URBLEVEL</a>
<a class="sourceLine" id="cb87-3" title="3"></a>
<a class="sourceLine" id="cb87-4" title="4">target.gwr.coefficients.classes_fx &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(target.gwr.coefficients, <span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">style=</span><span class="st">&quot;fixed&quot;</span>, </a>
<a class="sourceLine" id="cb87-5" title="5">                                                     <span class="dt">fixedBreaks=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">005</span>,<span class="op">-</span>.<span class="dv">003</span>,<span class="op">-</span>.<span class="dv">001</span>,.<span class="dv">001</span>,.<span class="dv">003</span>,.<span class="dv">005</span>), </a>
<a class="sourceLine" id="cb87-6" title="6">                                                     <span class="dt">rtimes =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Warning in classIntervals(target.gwr.coefficients, n = 5, style =
## &quot;fixed&quot;, : variable range greater than fixedBreaks</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">cols.gwr.coefficients &lt;-<span class="st"> </span><span class="kw">findColours</span>(target.gwr.coefficients.classes_fx, pal)</a>
<a class="sourceLine" id="cb89-2" title="2"></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">plot</span>(target, <span class="dt">col =</span> cols.gwr.coefficients, <span class="dt">main =</span> <span class="st">&quot;GWR Model (coefficients)&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">attr</span>(cols.gwr.coefficients,<span class="st">&quot;palette&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb89-5" title="5">       <span class="dt">legend =</span> <span class="kw">names</span>(<span class="kw">attr</span>(cols.gwr.coefficients, <span class="st">&quot;table&quot;</span>)),</a>
<a class="sourceLine" id="cb89-6" title="6">       <span class="dt">title =</span> <span class="st">&quot;Local Coefficient Estimates (urblevel)&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="conclusion_files/figure-html/pergunta_7-4.png" width="100%" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">moran.test</span>(target.gwr.coefficients, <span class="dt">listw =</span> lw, <span class="dt">zero.policy =</span> T)</a></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  target.gwr.coefficients  
## weights: lw    
## 
## Moran I statistic standard deviate = 41.759, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.9315389337     -0.0013280212      0.0004990371</code></pre>
<hr />
</div>
<div id="pergunta-8-bonus-2" class="section level1">
<h1>Pergunta 8 (bônus 2)</h1>
<p>Produza um mapa de alta qualidade do shapefile crime_mg utilizando a extensão tmap. Apresente o código completo e o mapa produzido em sua resposta.</p>
<p><strong>Resposta</strong></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co"># interactive map</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">tm_shape</span>(target) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;INDICE95&quot;</span>, </a>
<a class="sourceLine" id="cb92-5" title="5">              <span class="dt">id =</span> <span class="st">&quot;MUNIC&quot;</span>, </a>
<a class="sourceLine" id="cb92-6" title="6">              <span class="dt">title =</span> <span class="st">&quot;indice 1995&quot;</span>, </a>
<a class="sourceLine" id="cb92-7" title="7">              <span class="dt">contrast =</span> <span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb92-8" title="8">              <span class="dt">palette =</span> <span class="st">&quot;-Blues&quot;</span>,</a>
<a class="sourceLine" id="cb92-9" title="9">              <span class="dt">border.col =</span> <span class="st">&quot;gray30&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-10" title="10"><span class="st">  </span><span class="kw">tm_format</span>(<span class="st">&quot;World&quot;</span>) </a>
<a class="sourceLine" id="cb92-11" title="11"></a>
<a class="sourceLine" id="cb92-12" title="12"><span class="co"># classic map</span></a>
<a class="sourceLine" id="cb92-13" title="13"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a>
<a class="sourceLine" id="cb92-14" title="14"><span class="kw">tm_shape</span>(target) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-15" title="15"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;INDICE95&quot;</span>, <span class="dt">id =</span> <span class="st">&quot;MUNIC&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-16" title="16"><span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">position =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>), <span class="dt">color.light =</span> <span class="st">&quot;grey90&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-17" title="17"><span class="st">  </span><span class="kw">tm_credits</span>(<span class="st">&quot;Eckert IV projection&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;RIGHT&quot;</span>, <span class="st">&quot;BOTTOM&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-18" title="18"><span class="st">  </span><span class="kw">tm_style</span>(<span class="st">&quot;classic&quot;</span>)</a></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/ldaniel/Spatial-Statistics/master/images/tmap01.png" alt="Plot do tmap com alta qualidade." />
<p class="caption">Plot do tmap com alta qualidade.</p>
</div>
<div class="figure">
<img src="https://raw.githubusercontent.com/ldaniel/Spatial-Statistics/master/images/tmap02.png" alt="Outro plot do tmap com alta qualidade." />
<p class="caption">Outro plot do tmap com alta qualidade.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
